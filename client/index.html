<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="/socket.io/socket.io.js"></script>
    <!-- <script src="https://unpkg.com/axios/dist/axios.min.js"></script> -->

</head>

<body>
    <script>
        const socket = io.connect();
        if (window.max) {
            window.max.bindInlet("room_name", (roomName) => {
                console.log(roomName)
                socket.emit("room_name", {
                    "room": roomName,
                    "id": socket.id
                })
            })

            window.max.bindInlet("DM", (to, from, message) => {
                socket.emit("DM_IN", {
                    to: to,
                    from: from,
                    message: message
                });
            })

            window.max.bindInlet("leave_room", () => {
                socket.emit("leave_room", socket.id);
            })

            window.max.bindInlet("chat_message", (m) => {
                socket.emit("chat_message", m);
            })

            window.max.bindInlet("out1", (val) => {
                socket.emit("out1", val);
            })

            window.max.bindInlet("out2", (val) => {
                socket.emit("out2", val);
            })

            window.max.bindInlet("out3", (val) => {
                socket.emit("out3", val);
            })

            window.max.bindInlet("out4", (val) => {
                socket.emit("out4", val);
            })

            window.max.bindInlet("out5", (val) => {
                socket.emit("out1", val);
            })

            window.max.bindInlet("out6", (val) => {
                socket.emit("out2", val);
            })

            window.max.bindInlet("out7", (val) => {
                socket.emit("out3", val);
            })

            window.max.bindInlet("out8", (val) => {
                socket.emit("out4", val);
            })

            socket.on("chat_message", (m) => {
                let chat = '';
                m.forEach((element, index) => {
                    if (index > 0) chat += "\n" + element;
                    else chat += element;
                });
                window.max.outlet("message", chat);
            })

            socket.on("self_chat_message", (m) => {
                let chat = '';
                m.forEach((element, index) => {
                    if (index > 0) chat += "\n" + element;
                    else chat += element;
                });
                window.max.outlet("message", chat);
            })

            socket.on("DM_OUT", (m) => {
                let chat = '';
                m.forEach((element, index) => {
                    if (index > 0) chat += "\n" + element;
                    else chat += element;
                });
                window.max.outlet("dm", chat);
            })

            socket.on("cv_in1", (val) => {
                window.max.outlet('a ' + val);
            })

            socket.on("cv_in2", (val) => {
                window.max.outlet('b ' + val);
            })

            socket.on("cv_in3", (val) => {
                window.max.outlet('c ' + val);
            })

            socket.on("cv_in4", (val) => {
                window.max.outlet('d ' + val);
            })

            socket.on("cv_in5", (val) => {
                window.max.outlet('e ' + val);
            })

            socket.on("cv_in6", (val) => {
                window.max.outlet('f ' + val);
            })

            socket.on("cv_in7", (val) => {
                window.max.outlet('g ' + val);
            })

            socket.on("cv_in8", (val) => {
                window.max.outlet('h ' + val);
            })
        }
        socket.on("connect", () => console.log("connected to wss"));
        socket.on("error", (err) => console.log(err));

        let inputVal = '';
        const input = document.getElementById("input");
        input.onchange = () => inputVal = input.value;
        button = document.getElementById("submit");
        button.onclick = () => {

        }
    </script>

</body>

</html>